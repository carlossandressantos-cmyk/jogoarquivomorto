[build]
  command = """
    mkdir -p dist && \
    cp index.html dist/ && \
    cat > dist/env-config.js << 'EOF'
window.ENV = {
    FIREBASE_API_KEY: "REPLACE_API_KEY",
    FIREBASE_AUTH_DOMAIN: "REPLACE_AUTH_DOMAIN",
    FIREBASE_PROJECT_ID: "REPLACE_PROJECT_ID",
    FIREBASE_STORAGE_BUCKET: "REPLACE_STORAGE_BUCKET",
    FIREBASE_MESSAGING_SENDER_ID: "REPLACE_MESSAGING_SENDER_ID",
    FIREBASE_APP_ID: "REPLACE_APP_ID"
};
EOF
    sed -i "s|REPLACE_API_KEY|${FIREBASE_API_KEY}|g" dist/env-config.js && \
    sed -i "s|REPLACE_AUTH_DOMAIN|${FIREBASE_AUTH_DOMAIN}|g" dist/env-config.js && \
    sed -i "s|REPLACE_PROJECT_ID|${FIREBASE_PROJECT_ID}|g" dist/env-config.js && \
    sed -i "s|REPLACE_STORAGE_BUCKET|${FIREBASE_STORAGE_BUCKET}|g" dist/env-config.js && \
    sed -i "s|REPLACE_MESSAGING_SENDER_ID|${FIREBASE_MESSAGING_SENDER_ID}|g" dist/env-config.js && \
    sed -i "s|REPLACE_APP_ID|${FIREBASE_APP_ID}|g" dist/env-config.js && \
    echo "Build completed successfully" && \
    echo "Config file created with projectId: ${FIREBASE_PROJECT_ID}"
  """
  publish = "dist"
  ignore = "git diff --quiet $CACHED_COMMIT_REF $COMMIT_REF ."

[build.environment]
  NODE_VERSION = "18"
  SECRETS_SCAN_SMART_DETECTION_ENABLED = "false"

# Headers de seguranÃ§a
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
